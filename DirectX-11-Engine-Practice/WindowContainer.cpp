#include "WindowContainer.h"

LRESULT WindowContainer::WindowProc( HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam )
{
	switch ( uMsg )
	{
		// Keyboard Messages
		case WM_KEYDOWN:
		{
			unsigned char keycode = static_cast<unsigned char>( wParam );
			if ( keyboard.IsKeysAutoRepeat() )
			{
				keyboard.OnKeyPressed( keycode );
			}
			else
			{
				const bool wasPressed = lParam & 40000000;
				if ( !wasPressed )
				{
					keyboard.OnChar( keycode );
				}
			}
			return 0;
		}
		case WM_KEYUP:
		{
			unsigned char keycode = static_cast<unsigned char>( wParam );
			keyboard.OnKeyReleased( keycode );

			return 0;
		}
		case WM_CHAR:
		{
			unsigned char ch = static_cast<unsigned char>( wParam );
			if ( keyboard.IsCharsAutoRepeat() )
			{
				keyboard.OnChar( ch );
			}
			else
			{
				const bool wasPressed = lParam & 40000000;
				if ( !wasPressed )
				{
					keyboard.OnChar( ch );
				}
			}

			return 0;
		}
		// Mouse Messages
		case WM_MOUSEMOVE:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnMouseMove( x, y );
			return 0;
		}
		case WM_LBUTTONDOWN:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnLeftPressed( x, y );
			return 0;
		}
		case WM_RBUTTONDOWN:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnRightPressed( x, y );
			return 0;
		}
		case WM_MBUTTONDOWN:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnMiddlePressed( x, y );
			return 0;
		}
		case WM_LBUTTONUP:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnLeftReleased( x, y );
			return 0;
		}
		case WM_RBUTTONUP:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnRightReleased( x, y );
			return 0;
		}
		case WM_MBUTTONUP:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			mouse.OnMiddleReleased( x, y );
			return 0;
		}
		case WM_MOUSEWHEEL:
		{
			int x = LOWORD( lParam );
			int y = HIWORD( lParam );
			if ( GET_WHEEL_DELTA_WPARAM( wParam ) > 0 )
			{
				mouse.OnWheelUp( x, y );
			}
			else if ( GET_WHEEL_DELTA_WPARAM( wParam ) < 0 )
			{
				mouse.OnWheelDown( x, y );
			}
			break;
		}
		default:
			return DefWindowProc( hwnd, uMsg, wParam, lParam );
	}
}
